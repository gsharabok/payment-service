## Payment Service

Поддерживает основной функционал:
- REST API добавление пользователя
- REST API добавление транзакции (DEPOSIT или WITHDRAW)
- REST API получить информацию о транзакции
- REST API получить текущий баланс пользователя (без селекта всех транзакций) или баланс за дату (например, запрос "сколько у Васи было денег 5.05.2022 00:00")

Stack:
- python3
- sqlalchemy
- postgresql

Дополнительное:
- Развертывание в Kubernetes (в разработке):
Dockerfile, Deployment и Service.
- Обработка транзакций ровно один раз
Идемпотентность для обработки транзакций. У транзакция уникальный идентификатор, чтобы предотвратить дублирование обработки.
Используются транзакции базы данных, чтобы гарантировать, что запись транзакции и обновление баланса происходят атомарно.
Рассмотреть возможность использования очередей сообщений для обработки транзакций и обеспечения их обработки ровно один раз.
- Уведомление других сервисов:
Реализовать webhooks или модель pub/sub (например Kafka) для уведомления других сервисов (например, рекламного движка) о том, что произошла транзакция.
После успешного пополнения уведомить о событии, публикуя его в теме, на которую могут подписаться другие сервисы. Например, уведомить рекламный движок, который работает при наличии средств на счету.
- Инструменты контроля качества:
Линтеры (например pylint) для контроля качества кода.
Проверка типов (например mypy) для обеспечения типобезопасности.
Инструменты покрытия тестов (например, coverage.py) для обеспечения достаточного покрытия тестами.
Инструменты мониторинга (например, Prometheus, Grafana) для отслеживания производительности и состояния сервиса.
- Гарантия, что баланс пользователя не может быть отрицательным:
Нужнр логику в обработке транзакций, чтобы убедиться, что вывод средств не приведет к отрицательному балансу. (небольшая смена логики сохранения транзакции)
Если вывод средств приведет к отрицательному балансу, вернуть ошибку, указывающую на недостаток средств.# payment-service
